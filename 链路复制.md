背景：
目前小象的实时场景，缺乏高效的链路复制手段，即通过任务血缘关系，快速的进行生产了链路的复制，以此来解决数据修复、故障演练、链路压测等场景问题。
具体为：
- 数据修复:以前因为底层数据出现了错误，导致末端Doris聚合模型结果错误（bitmap去重计算），而这种错误并不能通过回溯去修复，只能先清理分区，再通过fixup任务进行修复，而出错的任务过于底层，依赖层级较多，考虑到手动复制链路成本和可能对生产链路产生影响，最终放弃了修复计划。因此，需要一个低成本快速的链路修复手段，在生产环境中的数据处理任务出现问题时，可以快速地复制链路到另一个隔离链路中，进行故障排查和问题修复，而不会影响到生产环境。
- 故障演练：通过复制任务链路在生产环境、测试环境中执行，可以进行故障恢复演练，验证当前故障恢复SOP的有效性和完整性。（SOP（Standard Operating Procedure），即标准作业程序，指将某一事件的标准操作步骤和要求以统一的格式描述出来，用于指导和规范日常的工作。SOP的精髓是将程序中的关键控制点进行细化和量化，从而能够将与该工作程序相关的经验、技术沉淀固化，便于任何人都可以快速学习和掌握高效的作业方法。）

- 链路压测：在不同的负载下，对生产环境进行模拟，识别高负载情况下可能出现的问题。

实现步骤：

血缘关系分析：基于平台提供的任务血缘，分析并提取任务之间的血缘关系。

任务链路解析：根据血缘关系结果，解析出完整的任务链路，包括任务名称、任务类型、层级、任务相关配置参数等。

环境准备：在相关环境中准备好相应的计算资源和配置，确保任务链路可以在新环境中运行。

任务复制：复制待修复/压测/故障演练的任务，以及该任务所有层级的上下游任务的FIXUP任务。

任务配置调整：对新生成的任务配置进行个性化的调整，比如删除不需要修复的节点任务，调整计算资源配额等。

任务执行与监控：选择起点任务和重点任务，批量提交上线，待任务上线后，对任务执行过程进行监控，以便及时发现并处理可能出现的问题。

结果验证：对比任务执行结果与预期结果或生产环境中的结果，验证压力测试或问题修复的效果，如无问题进行切表操作。

任务下线：如已完成修复/压测/故障演练，一键下线所有相关任务，释放资源。

产出形式：
- 链路复制接口：输入待修复任务，返回该任务的fixup任务以及下上游所有的fixup任务。
- 链路复制工具：支持链路复制、故障演练、压测等多个场景。
![alt text](image-1.png)



todo：明确上下游信息/引擎
遇到的问题
可能的挑战